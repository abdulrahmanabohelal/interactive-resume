<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini-Powered Resume Editor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        /* Custom styles for the icons */
        .icon {
            fill: #6b7280; /* Gray-500 */
        }
        .icon-link {
            transition: fill 0.2s ease-in-out;
        }
        .icon-link:hover .icon {
            fill: #3b82f6; /* Blue-500 */
        }
    </style>
</head>
<body class="bg-gray-100 p-8 flex justify-center items-start min-h-screen">

    <div id="app" class="bg-white rounded-lg shadow-2xl p-8 max-w-5xl w-full flex flex-col lg:flex-row">

        <!-- Left Column - Personal Info -->
        <div class="lg:w-1/3 w-full p-6 bg-gray-50 rounded-lg shadow-inner flex flex-col items-center lg:items-start lg:mr-8 mb-8 lg:mb-0">
            <!-- Personal Photo -->
            <div class="mb-6">
                <!--
                    Note: This is a placeholder image.
                    Please replace the 'https://' URL below with the URL of your own personal photo.
                    You can also use a base64-encoded image if you prefer.
                -->
                <img src="https://placehold.co/200x200/FFFFFF/000000?text=Your+Photo" alt="Abdulrahman Abohelal" class="rounded-full w-48 h-48 border-4 border-white shadow-lg">
            </div>

            <!-- Name and Title -->
            <div class="text-center lg:text-left mb-6">
                <h1 class="text-3xl font-bold text-gray-800">Abdulrahman Abohelal</h1>
                <h2 class="text-lg font-semibold text-blue-600">BIM Structural Engineer</h2>
            </div>

            <!-- Contact Info -->
            <div class="w-full text-center lg:text-left text-gray-700 mb-8">
                <div class="flex items-center mb-2 justify-center lg:justify-start">
                    <svg class="icon w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"></path>
                    </svg>
                    <span>Nasr City, Cairo, Egypt</span>
                </div>
                <div class="flex items-center mb-2 justify-center lg:justify-start">
                    <svg class="icon w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 3a1 1 0 011-1h2.153a1 1 0 01.986.836l.74 4.435a1 1 0 01-.54 1.06l-1.548.774a11.096 11.096 0 006.105 6.105l.774-1.548a1 1 0 011.06-.54l4.435.74a1 1 0 01.836.986V17a1 1 0 01-1 1h-2C7.82 18 2 12.18 2 5V3z"></path>
                    </svg>
                    <span>+20 102 737 0971</span>
                </div>
                <div class="flex items-center mb-2 justify-center lg:justify-start">
                    <svg class="icon w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"></path>
                        <path d="M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"></path>
                    </svg>
                    <span>Abdulrahman.Abohelal@gmail.com</span>
                </div>
                <div class="flex items-center justify-center lg:justify-start">
                    <svg class="icon w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M16 4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2H6a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2v-8a2 2 0 00-2-2h-2V4zm-3 8v2h-2v-2h2zm-2-2h2V8h-2v2z" clip-rule="evenodd"></path>
                    </svg>
                    <span><a href="https://linkedin.com/in/abdulrahman-abohelal" target="_blank" class="text-blue-600 hover:underline">linkedin.com/in/abdulrahman-abohelal</a></span>
                </div>
            </div>

            <!-- Navigation-like buttons -->
            <button class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm mb-4">
                Overview
            </button>
            <button class="w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg shadow-md hover:bg-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-400 focus:ring-opacity-50 text-sm">
                Skills Dashboard
            </button>
        </div>

        <!-- Right Column - Resume Content -->
        <div class="lg:w-2/3 w-full flex flex-col gap-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-6 hidden lg:block">Career Overview</h1>

            <!-- Professional Profile Section -->
            <div class="p-6 bg-gray-50 rounded-lg shadow-inner">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-xl font-semibold text-gray-700">Professional Profile</h2>
                    <button id="generateProfileBtn" class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm">
                        ✨ Generate Profile
                    </button>
                </div>
                <div id="profileSummary" contenteditable="true" class="p-4 bg-white rounded-lg border border-gray-300 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200">
                    Structural Technical Office Engineer with three years' experience in both consulting and contracting environments. Skilled at producing BIM shop drawings, performing structural analysis, and coordinating cross-disciplinary models. Proficient in Revit, Civil 3D, Navisworks, and AutoCAD Structural Detailing. Focused on delivering precise BIM-based documentation for complex projects.
                </div>
            </div>

            <!-- Professional Experience Section -->
            <div class="p-6 bg-gray-50 rounded-lg shadow-inner">
                <h2 class="text-xl font-semibold text-gray-700 mb-4">Professional Experience</h2>
                <div contenteditable="true" class="p-4 bg-white rounded-lg border border-gray-300 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200">
                    <p class="font-bold">BIM Structural Technical Office Engineer – SIAC</p>
                    <p class="text-sm text-gray-500 mb-2">March 2025 – Present</p>
                    <ul class="list-disc pl-5">
                        <li>Produced accurate BIM-based structural shop drawings for high-rise buildings and high-speed rail (HSR) stations.</li>
                        <li>Developed and maintained coordinated 3D structural models aligned with architectural and MEP teams using Revit.</li>
                        <li>Prepared quantity take-offs and reinforcement schedules from BIM models.</li>
                    </ul>
                </div>
                <div contenteditable="true" class="p-4 mt-4 bg-white rounded-lg border border-gray-300 text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200">
                    <p class="font-bold">Site Engineer – MFJV – Trading and Contracting Company</p>
                    <p class="text-sm text-gray-500 mb-2">September 2022 – November 2023</p>
                    <ul class="list-disc pl-5">
                        <li>Supervised Mariouteya Canal lining (14 km) using sulphate-resistant cement.</li>
                        <li>Oversaw steelwork and carpentry for 45m port partition in New Ain Sokhna.</li>
                    </ul>
                </div>
            </div>

            <!-- Gemini Tools Section -->
            <div class="p-6 bg-gray-50 rounded-lg shadow-inner">
                <h2 class="text-xl font-semibold text-gray-700 mb-4">Gemini Tools</h2>
                
                <p class="text-sm text-gray-600 mb-6">Select a section of text in the resume to refine it or use the buttons below to generate content.</p>

                <!-- Refine Text Button -->
                <button id="refineTextBtn" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm mb-4" disabled>
                    ✨ Refine Selected Text
                </button>

                <!-- Generate Interview Questions Button -->
                <button id="generateQuestionsBtn" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm mb-4">
                    ✨ Generate Interview Questions
                </button>
                
                <!-- NEW: Generate Cover Letter Button -->
                <button id="generateCoverLetterBtn" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm mb-4">
                    ✨ Generate Cover Letter
                </button>
                
                <!-- NEW: Analyze Skills Button -->
                <button id="analyzeSkillsBtn" class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg shadow-md hover:bg-blue-700 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 text-sm">
                    ✨ Analyze Skill Gaps
                </button>

                <div class="mt-8">
                    <h3 class="text-lg font-semibold text-gray-700 mb-2">Results:</h3>
                    <div id="results" class="p-4 bg-white rounded-lg border border-gray-300 min-h-[100px] text-gray-800 whitespace-pre-wrap overflow-y-auto max-h-96">
                        <p class="text-gray-400">Your results will appear here.</p>
                    </div>
                </div>
            </div>

            <!-- Message Box for user feedback -->
            <div id="messageBox" class="fixed bottom-4 right-4 bg-blue-600 text-white px-6 py-3 rounded-lg shadow-lg hidden transition-opacity duration-300 opacity-0">
                <span id="messageText"></span>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Function to show a temporary message box
            const showMessage = (text) => {
                const messageBox = document.getElementById('messageBox');
                const messageText = document.getElementById('messageText');
                messageText.textContent = text;
                messageBox.classList.remove('hidden');
                setTimeout(() => {
                    messageBox.classList.add('opacity-100');
                    setTimeout(() => {
                        messageBox.classList.remove('opacity-100');
                        setTimeout(() => {
                            messageBox.classList.add('hidden');
                        }, 300);
                    }, 3000);
                }, 100);
            };

            // Global variable for the API key, provided by the runtime environment
            const apiKey = "";

            // Function to make an LLM API call
            async function callGeminiAPI(prompt, systemInstruction) {
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
                
                // Add the system instruction to the payload
                const payload = {
                    contents: [{ parts: [{ text: prompt }] }],
                    systemInstruction: { parts: [{ text: systemInstruction }] }
                };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`API error: ${JSON.stringify(errorData)}`);
                    }

                    const result = await response.json();
                    return result.candidates[0].content.parts[0].text;
                } catch (error) {
                    console.error('Error calling Gemini API:', error);
                    showMessage('Error: Could not connect to Gemini API. Check the console for details.');
                    return null;
                }
            }

            // --- LLM Feature 1: Generate Profile Summary ---
            const generateProfileBtn = document.getElementById('generateProfileBtn');
            const profileSummaryDiv = document.getElementById('profileSummary');
            
            generateProfileBtn.addEventListener('click', async () => {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = '<p class="text-gray-400 animate-pulse">Generating profile...</p>';
                generateProfileBtn.disabled = true;

                const resumeContent = document.getElementById('app').innerText; // Get all text from the resume
                const prompt = `Based on the following resume content, write a concise and professional profile summary. The summary should highlight key skills and experience. Do not mention "based on the resume".

Resume content:
${resumeContent}`;

                const systemInstruction = `You are a professional resume writer. Your task is to generate a compelling and concise profile summary for a resume. The summary should be written from the first person perspective (e.g., "Skilled at..."), but without using "I". Focus on actionable skills and achievements.`;

                const generatedText = await callGeminiAPI(prompt, systemInstruction);

                if (generatedText) {
                    profileSummaryDiv.textContent = generatedText.trim();
                    resultsDiv.innerHTML = '<p class="text-green-500">Profile generated successfully!</p>';
                } else {
                    resultsDiv.innerHTML = '<p class="text-red-500">Generation failed.</p>';
                }
                generateProfileBtn.disabled = false;
            });

            // --- LLM Feature 2: Refine Selected Text ---
            const refineTextBtn = document.getElementById('refineTextBtn');
            const resultsDiv = document.getElementById('results');
            let selectedText = '';

            document.addEventListener('selectionchange', () => {
                const selection = window.getSelection();
                selectedText = selection.toString().trim();
                refineTextBtn.disabled = selectedText.length === 0;
            });

            refineTextBtn.addEventListener('click', async () => {
                if (selectedText) {
                    resultsDiv.innerHTML = '<p class="text-gray-400 animate-pulse">Refining text...</p>';
                    refineTextBtn.disabled = true;

                    const prompt = `Refine the following text to make it sound more professional, active, and impactful for a resume. Keep the original meaning but improve the phrasing and word choice.

Text to refine:
"${selectedText}"`;

                    const systemInstruction = `You are a professional resume editor. Your task is to take a piece of text and rewrite it to be more impactful and professional, suitable for a resume. Use strong action verbs and professional language. Provide only the refined text, nothing else.`;

                    const refinedText = await callGeminiAPI(prompt, systemInstruction);

                    if (refinedText) {
                        resultsDiv.innerHTML = `<h4 class="font-bold mb-2">Refined Text:</h4><p>${refinedText}</p>`;
                        showMessage('Text refined successfully!');
                    } else {
                        resultsDiv.innerHTML = '<p class="text-red-500">Refinement failed.</p>';
                    }
                    refineTextBtn.disabled = false;
                }
            });

            // --- LLM Feature 3: Generate Interview Questions ---
            const generateQuestionsBtn = document.getElementById('generateQuestionsBtn');
            
            generateQuestionsBtn.addEventListener('click', async () => {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = '<p class="text-gray-400 animate-pulse">Generating questions...</p>';
                generateQuestionsBtn.disabled = true;

                const resumeContent = document.getElementById('app').innerText; // Get all text from the resume
                const prompt = `Based on the following resume content, generate 5 relevant interview questions a hiring manager might ask. Categorize the questions.

Resume content:
${resumeContent}`;

                const systemInstruction = `You are a career coach. Your task is to generate a list of 5 interview questions based on a candidate's resume. The questions should be insightful and designed to help the candidate prepare for their interview. Present the questions clearly and number them.`;

                const questions = await callGeminiAPI(prompt, systemInstruction);

                if (questions) {
                    resultsDiv.innerHTML = `<h4 class="font-bold mb-2">Potential Interview Questions:</h4><p>${questions}</p>`;
                    showMessage('Interview questions generated!');
                } else {
                    resultsDiv.innerHTML = '<p class="text-red-500">Generation failed.</p>';
                }
                generateQuestionsBtn.disabled = false;
            });

            // --- NEW LLM Feature 4: Generate Cover Letter ---
            const generateCoverLetterBtn = document.getElementById('generateCoverLetterBtn');

            generateCoverLetterBtn.addEventListener('click', async () => {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = '<p class="text-gray-400 animate-pulse">Generating cover letter...</p>';
                generateCoverLetterBtn.disabled = true;

                const resumeContent = document.getElementById('app').innerText;
                const prompt = `Write a professional cover letter based on the following resume content. Use a formal tone and do not include placeholders like "company name" or "hiring manager". The cover letter should highlight the candidate's key skills and experience as a structural engineer.

Resume content:
${resumeContent}`;

                const systemInstruction = `You are a professional cover letter writer. Your task is to write a formal cover letter for a candidate based on their resume. The letter should be well-structured, professional, and highlight key qualifications without needing a specific job description.`;

                const coverLetter = await callGeminiAPI(prompt, systemInstruction);

                if (coverLetter) {
                    resultsDiv.innerHTML = `<h4 class="font-bold mb-2">Draft Cover Letter:</h4><p class="whitespace-pre-wrap">${coverLetter}</p>`;
                    showMessage('Cover letter generated!');
                } else {
                    resultsDiv.innerHTML = '<p class="text-red-500">Generation failed.</p>';
                }
                generateCoverLetterBtn.disabled = false;
            });
            
            // --- NEW LLM Feature 5: Analyze Skill Gaps ---
            const analyzeSkillsBtn = document.getElementById('analyzeSkillsBtn');

            analyzeSkillsBtn.addEventListener('click', async () => {
                const resultsDiv = document.getElementById('results');
                resultsDiv.innerHTML = '<p class="text-gray-400 animate-pulse">Analyzing skills...</p>';
                analyzeSkillsBtn.disabled = true;

                const resumeContent = document.getElementById('app').innerText;
                const prompt = `Based on the following resume, identify potential skill gaps or areas for professional development for a structural engineer. Provide actionable suggestions on how to improve. The suggestions should be practical and relevant to the industry.

Resume content:
${resumeContent}`;

                const systemInstruction = `You are a career development expert specializing in engineering. Your task is to analyze a resume and provide constructive, professional feedback on skill gaps and areas for growth. Present your analysis clearly using bullet points and a concluding summary.`;

                const skillAnalysis = await callGeminiAPI(prompt, systemInstruction);

                if (skillAnalysis) {
                    resultsDiv.innerHTML = `<h4 class="font-bold mb-2">Skill Gap Analysis:</h4><p class="whitespace-pre-wrap">${skillAnalysis}</p>`;
                    showMessage('Skill analysis complete!');
                } else {
                    resultsDiv.innerHTML = '<p class="text-red-500">Analysis failed.</p>';
                }
                analyzeSkillsBtn.disabled = false;
            });

        });
    </script>
</body>
</html>
